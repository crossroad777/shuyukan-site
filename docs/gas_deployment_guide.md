# Google Apps Script デプロイ手順ガイド

Google Apps Script (GAS) を正しくデプロイし、ウェブサイトと連携させるための手順です。

## ステップ 1: コードの準備

1. [unified_apps_script.gs](file:///c:/Users/kotan/Desktop/shuyukan/shuyukan-react-starter-runnable/shuyukan-react-starter/docs/unified_apps_script.gs) の全内容をコピーします。

## ステップ 2: GAS エディタで貼り付け

1. 対象の Google スプレッドシートを開き、メニューの **「拡張機能」 > 「Apps Script」** を選択します。
2. エディタ内の既存のコードをすべて削除し、ステップ 1 でコピーした内容を貼り付けます。
3. 左上の「保存（フロッピーディスク・アイコン）」を押して保存します。

## ステップ 3: 新規デプロイ

1. 画面右上の **「デプロイ」** ボタンを押し、**「新しいデプロイ」** を選択します。
2. 種類の選択（歯車アイコン）で **「ウェブアプリ」** を選択します。
3. 設定を以下のように指定します：
   - **説明**: `Shuyukan Unified API v1` (任意)
   - **次のユーザーとして実行**: **「自分」**
   - **アクセスできるユーザー**: **「全員」** (これが重要です。匿名アクセスを許可します)
4. **「デプロイ」** ボタンを押します。

## ステップ 4: アクセスの承認

1. 「アクセスを承認」というポップアップが出たら、自分の Google アカウントを選択します。
2. 「このアプリは Google で確認されていません」と表示された場合は：
   - **「詳細」** をクリック。
   - 左下の **「（プロジェクト名）に移動（安全ではない）」** をクリック。
3. **「許可」** をクリックします。

## ステップ 5: URL のコピーと .env の更新

1. デプロイ完了画面に表示される **「ウェブアプリ」の URL** をコピーします。
2. React プロジェクトのルートにある `.env` ファイルを開き、以下の 2 項目を同じ URL で書き換えます：

   ```env
   VITE_MEMBER_API_URL=コピーしたURL
   VITE_NEWS_API_URL=コピーしたURL
   ```

3. 保存後、React の開発サーバー（npm run dev）を再起動して動作を確認してください。

> [!IMPORTANT]
> スプレッドシートに「会員」と「お知らせ」という名前のシートが存在することを確認してください。なければスクリプトがエラーになります。
