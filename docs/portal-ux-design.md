# 豊中修猷館 権限分離ポータル システム設計仕様書

## 1. 基本設計思想

本システムは、**「管理者がすべての制御を行い、部員は承認された情報を閲覧・活用するのみ」**という主従関係を技術的・視覚的に徹底します。

| 項目 | 部員用ポータル (Member) | 管理者用ポータル (Admin) |
| --- | --- | --- |
| **目的** | 情報の確認・活用・DL | 情報の生成・更新・管理 |
| **権限** | 閲覧・ダウンロードのみ | フルアクセス（追加・更新・削除） |
| **用語** | 柔らかい表現（見る・知る） | 直接的表現（管理・編集・設定） |
| **色調** | 深紺（信頼・静謐） | 赤（情熱・指導・管理） |

---

## 2. 画面・メニュー構成（厳格な分離）

### 👤 部員用画面 (Member Dashboard)

部員が「見るだけ」で迷わない、シンプルかつ受動的なUI。

**メニュー項目名の工夫:**

- 📖 **部員用ガイド**: (旧: マニュアル) 会の決まり事などを確認
- 📅 **予定されている行事**: (旧: 行事管理) 今後のイベントを確認
- 🗓️ **稽古日程表**: 具体的な場所と時間を確認
- 🔑 **緊急連絡網・当番**: 連絡先や当番の割り当てを確認
- 📁 **共有配布資料**: (旧: ドキュメント) 配布資料、申請書のダウンロード

> [!NOTE]
> **用語のルール**: 「管理」「編集」「設定」「追加」「削除」という言葉を**一切使用しない**。

---

### ⚙️ 管理者用画面 (Admin Console)

管理者が効率的に運営を行える、能動的で機能密度の高いUI。

**メニュー項目名:**

- 📖 **ガイド編集**: 部員用ガイドの内容を更新
- 📅 **行事予定の管理**: イベントの追加・変更・中止
- 🗓️ **稽古スケジュールの管理**: 日程・場所の割り振りと一括反映
- 🔑 **当番・連絡網の編成**: 割り当ての編集
- 📤 **ファイル一括管理**: PDFやWordのアップロード・入替・削除

---

## 3. 権限・機能設計 (RBAC: Role Based Access Control)

### 権限マトリクス

| 機能 | 部員 (Member) | 管理者 (Admin) | 実装方法 |
| --- | --- | --- | --- |
| **お知らせ** | 閲覧のみ | 投稿・編集・削除 | NewsService + NewsModal |
| **ドキュメント** | DL / プレビューのみ | 整理・アップロード | Drive API / DocumentManager |
| **出欠記録** | 閲覧（自分の状況） | 全員の記録・統計 | AttendanceDashboard |
| **名簿管理** | アクセス不可 | 閲覧・編集・承認 | AdminDashboard |
| **会計データ** | アクセス不可 | 入力・グラフ閲覧 | AccountingService |

---

## 4. Google連携と自動反映の仕組み

1. **データの同期**:
    - 管理者が「管理者ポータル」でボタンを押すと、Google Sheets（データベース）やGoogle Drive（ファイル）が即座に更新されます。
    - 部員ポータルは常にこれら最新の共通リソースを参照するため、**管理者の操作は即座に（リロードなし、または次回アクセス時に）部員へ反映**されます。
2. **ファイル配布**:
    - 管理者が特定のGoogle Driveフォルダにファイルを放り込むだけで、部員画面の「共有フォルダ」一覧に自動的に公開されます。

---

## 5. 視覚的・心理的デザイン

### ロールの明確化

- **ヘッダーカラー**:
  - 管理者: `bg-red-700` (重厚な赤)
  - 部員: `bg-shuyukan-blue` (信頼の青)
- **バッジ**:
  - 管理者: 「管理者 🛡️」
  - 部員: 「所属部員 ⚔️ (閲覧専用)」

### 誤操作防止

- 部員用ポータルで使用する `DocumentManager` などの共通コンポーネントには `readOnly={true}` フラグを渡し、プログラムレベルでボタン表示やAPI呼び出しを制限します。
