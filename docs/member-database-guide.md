# 会員データベース セットアップガイド

Googleスプレッドシートを使用した会員管理システムの構築手順です。

---

## 概要

```
【構造】
┌─────────────────┐     ┌─────────────────┐
│   会員マスター    │────▶│  世帯マスター    │
│  （子供の情報）   │     │ （保護者の情報） │
└─────────────────┘     └─────────────────┘
         │
         ▼
┌─────────────────┐
│    出席記録      │
│ （稽古の参加）   │
└─────────────────┘
```

**ポイント：**

- 兄弟は同じ「世帯ID」で紐付け
- 保護者情報は1箇所で管理（変更時も楽）
- 出席記録は別シートで蓄積

---

## 手順1：スプレッドシートを作成

1. **Googleドライブ**にアクセス  
   → [https://drive.google.com](https://drive.google.com)

2. 「**+ 新規**」→「**Googleスプレッドシート**」→「空白のスプレッドシート」

3. 名前を設定：`修猷館_会員データベース`

---

## 手順2：シートを作成

スプレッドシート下部のタブで、以下の4つのシートを作成します：

1. `会員マスター`
2. `世帯マスター`
3. `出席記録`
4. `会費管理`

---

## 手順3：各シートの構造

### シート1: 会員マスター

1行目（ヘッダー）に以下を入力：

| 列 | 項目名 | 説明 |
|---|---|---|
| A | 会員番号 | S001, S002... |
| B | 世帯ID | F001, F002...（世帯マスターと紐付け） |
| C | 氏名 | 山田 太郎 |
| D | ふりがな | やまだ たろう |
| E | 生年月日 | 2015-08-20 |
| F | 性別 | 男 / 女 |
| G | 学年 | 小学4年 / 中学1年 / 一般 |
| H | 会員種別 | 少年部 / 一般部 |
| I | 段級位 | 2級 / 初段 / 二段 |
| J | 入会日 | 2023-04-01 |
| K | ステータス | 在籍 / 休会 / 退会 |
| L | 備考 | アレルギー情報など |

**入力例：**

| 会員番号 | 世帯ID | 氏名 | ふりがな | 生年月日 | 性別 | 学年 | 会員種別 | 段級位 | 入会日 | ステータス | 備考 |
|---|---|---|---|---|---|---|---|---|---|---|---|
| S001 | F001 | 鈴木 健太 | すずき けんた | 2015-08-20 | 男 | 小学4年 | 少年部 | 2級 | 2023-04-01 | 在籍 | |
| S002 | F001 | 鈴木 美咲 | すずき みさき | 2017-03-15 | 女 | 小学2年 | 少年部 | 5級 | 2024-04-01 | 在籍 | ← 兄弟（同じ世帯ID） |
| S003 | F002 | 田中 翔太 | たなか しょうた | 2014-11-05 | 男 | 小学5年 | 少年部 | 1級 | 2022-04-01 | 在籍 | |

---

### シート2: 世帯マスター

1行目（ヘッダー）に以下を入力：

| 列 | 項目名 | 説明 |
|---|---|---|
| A | 世帯ID | F001, F002... |
| B | 保護者名 | 鈴木 一郎 |
| C | ふりがな | すずき いちろう |
| D | 続柄 | 父 / 母 / 祖父 / 祖母 |
| E | 電話番号 | 090-1234-5678 |
| F | メールアドレス | <suzuki@example.com> |
| G | 郵便番号 | 123-4567 |
| H | 住所 | 東京都○○区△△町1-2-3 |
| I | 緊急連絡先 | 090-9876-5432 |
| J | 備考 | |

**入力例：**

| 世帯ID | 保護者名 | ふりがな | 続柄 | 電話番号 | メールアドレス | 郵便番号 | 住所 | 緊急連絡先 | 備考 |
|---|---|---|---|---|---|---|---|---|---|
| F001 | 鈴木 一郎 | すずき いちろう | 父 | 090-1234-5678 | <suzuki@example.com> | 123-4567 | 東京都... | 090-8765-4321 | |
| F001 | 鈴木 花子 | すずき はなこ | 母 | 090-8765-4321 | <hanako@example.com> | 123-4567 | 東京都... | 090-1234-5678 | ← 同じ世帯の別保護者 |
| F002 | 田中 次郎 | たなか じろう | 父 | 080-1111-2222 | <tanaka@example.com> | 456-7890 | 神奈川県... | 080-3333-4444 | |

---

### シート3: 出席記録

1行目（ヘッダー）に以下を入力：

| 列 | 項目名 | 説明 |
|---|---|---|
| A | 日付 | 2026-01-11 |
| B | 曜日 | 土 |
| C | 会員番号 | S001 |
| D | 氏名 | 鈴木 健太（自動入力可） |
| E | 出席時刻 | 09:05 |
| F | 備考 | 早退など |

**入力例：**

| 日付 | 曜日 | 会員番号 | 氏名 | 出席時刻 | 備考 |
|---|---|---|---|---|---|
| 2026-01-11 | 土 | S001 | 鈴木 健太 | 09:05 | |
| 2026-01-11 | 土 | S002 | 鈴木 美咲 | 09:08 | |
| 2026-01-11 | 土 | S003 | 田中 翔太 | 09:15 | |

---

### シート4: 会費管理

1行目（ヘッダー）に以下を入力：

| 列 | 項目名 |
|---|---|
| A | 会員番号 |
| B | 氏名 |
| C | 月額 |
| D | 2026年1月 |
| E | 2026年2月 |
| F | 2026年3月 |
| ... | （月ごとに列を追加） |

**入力例：**

| 会員番号 | 氏名 | 月額 | 2026年1月 | 2026年2月 | 2026年3月 |
|---|---|---|---|---|---|
| S001 | 鈴木 健太 | ¥3,000 | ✓ | ✓ | |
| S002 | 鈴木 美咲 | ¥3,000 | ✓ | ✓ | |
| S003 | 田中 翔太 | ¥3,000 | ✓ | | |

---

## 手順4：便利な数式（オプション）

### 会員マスターで年齢を自動計算

M列に「年齢」を追加し、以下の数式を入力：

```
=DATEDIF(E2, TODAY(), "Y")
```

### 会員マスターで保護者名を自動表示

N列に「主保護者」を追加し、以下の数式を入力：

```
=IFERROR(VLOOKUP(B2, '世帯マスター'!A:B, 2, FALSE), "")
```

### 出席記録で氏名を自動入力

D列に以下の数式を入力：

```
=IFERROR(VLOOKUP(C2, '会員マスター'!A:C, 3, FALSE), "")
```

---

## 手順5：データの入力規則（推奨）

### 性別のドロップダウン

1. 会員マスターのF列を選択
2. 「データ」→「データの入力規則」
3. 「リストを直接指定」→ `男,女`

### ステータスのドロップダウン

1. 会員マスターのK列を選択
2. 「データ」→「データの入力規則」
3. 「リストを直接指定」→ `在籍,休会,退会`

### 会員種別のドロップダウン

1. 会員マスターのH列を選択
2. 「データ」→「データの入力規則」
3. 「リストを直接指定」→ `少年部,一般部`

---

## 手順6：条件付き書式（推奨）

### 退会者をグレーアウト

1. 会員マスターのA2:L100を選択
2. 「表示形式」→「条件付き書式」
3. 「カスタム数式」→ `=$K2="退会"`
4. 書式：背景色をグレーに設定

### 休会者を黄色ハイライト

1. 同様に設定
2. 「カスタム数式」→ `=$K2="休会"`
3. 書式：背景色を薄い黄色に設定

---

## 完成後のデータベース構造

```
修猷館_会員データベース
├── 会員マスター（子供の情報）
│   └── 世帯IDで保護者と紐付け
├── 世帯マスター（保護者の情報）
│   └── 同じ世帯IDで複数保護者・兄弟を管理
├── 出席記録（稽古参加履歴）
│   └── 会員番号で会員と紐付け
└── 会費管理（支払い状況）
    └── 月別の支払いを記録
```

---

## 次のステップ

このデータベースが完成したら、以下の機能を追加できます：

1. **タブレット出席管理システム**
   - 稽古日にタブレットで会員がボタンを押して出席を記録
   - Apps Scriptでスプレッドシートに自動保存

2. **Webサイト管理画面**（将来）
   - Google認証でログイン
   - 会員一覧の閲覧・編集

3. **自動メール送信**（将来）
   - 稽古情報を保護者にメール配信

---

## 参考リンク

- [Googleスプレッドシート ヘルプ](https://support.google.com/docs/answer/6000292)
- [VLOOKUP関数の使い方](https://support.google.com/docs/answer/3093318)
- [データの入力規則](https://support.google.com/docs/answer/186103)
